<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spotify Wrapped ($SPOTIFY) â€“ Viral Recap Moonshot</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=Inter:wght@400;700&family=VT323&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.min.js"></script>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:linear-gradient(135deg, #000, #1a1a2e, #16213e); color:#00ff88; overflow-x:hidden; font-family:'Inter',sans-serif; }
    .neon { text-shadow:0 0 10px #00ff88, 0 0 20px #00ff88; }
    .playlist-bg { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; opacity:0.1; }
    .terminal { background:#000; border:2px solid #00ff88; padding:1rem; font-family:'VT323',monospace; }
    .wrapped-logo { font-family:'Orbitron',sans-serif; font-weight:900; }
    .scanline::before { content:''; position:absolute; inset:0; background:linear-gradient(transparent,rgba(0,255,136,0.05),transparent); animation:scan 3s linear infinite; }
    @keyframes scan { 0%{transform:translateY(-100%)} 100%{transform:translateY(100%)} }
    .beat { animation:pulse 1s infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.5; transform:scale(1.05)} }
    .social{width:40px;height:40px;background:#00ff88;color:#000;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;text-decoration:none;}
  </style>
</head>
<body class="text-green-400">

<!-- BACKGROUND -->
<canvas class="playlist-bg" id="playlist"></canvas>

<!-- HERO -->
<section id="hero" class="relative min-h-screen flex flex-col items-center justify-center overflow-hidden">
  <div class="scanline absolute inset-0"></div>

  <h1 class="wrapped-logo neon text-8xl md:text-9xl mb-4 beat">SPOTIFY WRAPPED</h1>

  <p id="terminal-line" class="mt-4 text-xl opacity-0 text-center"></p>

  <button id="buy-hero"
    onclick="window.open('https://pump.fun/coin/HzTpFozNhZ51Vra4jDg8J5uYxvRpA6dv7vey2M4tpump')"
    class="mt-8 px-8 py-4 border-2 border-green-400 text-green-400 hover:bg-green-400 hover:text-black transition text-lg font-bold rounded-full">
    PLAY $SPOTIFY
  </button>

  <div id="real-ticker" class="mt-6 text-sm opacity-0 flex flex-col items-center space-y-1 bg-black/50 p-4 rounded-lg"></div>
</section>

<!-- LORE -->
<section id="recap" class="min-h-screen flex items-center justify-center p-8 relative">
  <div class="scanline absolute inset-0"></div>
  <p id="lore" class="text-2xl max-w-2xl text-center opacity-0 neon"></p>
</section>

<!-- âœ… DEXSCREENER STATS (REPLACED TOKENOMICS) -->
<section id="dexstats" class="min-h-screen flex items-center justify-center p-8 relative">
  <div class="scanline absolute inset-0"></div>

  <div class="w-full max-w-md bg-black/40 p-6 rounded-xl border border-green-400 text-center">
    <h2 class="text-3xl font-bold mb-6 neon">Live SPOTIFY Stats</h2>

    <!-- â­ DexScreener Mini Stats Card (No Chart) -->
    <iframe 
      src="https://dexscreener.com/solana/g62zdmyefqkuqdhrifn5fyyck2ioqvgpeyhe3pz6ocm8?embed=1&theme=dark&trades=0&info=1&chart=0"
      style="width:100%; height:180px; border:0; border-radius:12px;">
    </iframe>
  </div>
</section>

<!-- COMMUNITY -->
<section id="community" class="min-h-screen p-8 flex flex-col items-center">
  <div id="tweets" class="space-y-4 w-full max-w-xl"></div>

  <a href="https://x.com/i/communities/1987214294996689034" target="_blank"
    class="mt-8 terminal w-full max-w-md text-center py-4">
    Join Spotify Wrapped Community
  </a>
</section>

<!-- BUY -->
<section id="buy" class="min-h-screen flex items-center justify-center p-8">
  <div class="terminal w-full max-w-md text-center">

    <p class="mb-4">Contract: <span class="break-all">HzTpFozNhZ51Vra4jDg8J5uYxvRpA6dv7vey2M4tpump</span></p>
    <p>You pay: <span id="pay">0.1 SOL</span></p>
    <p>You get: <span id="get">~987,000 $SPOTIFY</span></p>

    <!-- â­ Pump.fun Buy Button -->
    <a href="https://pump.fun/coin/HzTpFozNhZ51Vra4jDg8J5uYxvRpA6dv7vey2M4tpump" target="_blank"
      class="mt-4 w-full py-2 border border-green-400 hover:bg-green-400 hover:text-black transition block">
      Buy on Pump.fun
    </a>
  </div>
</section>

<!-- FOOTER -->
<footer class="p-8 text-center text-sm">
  <p>$SPOTIFY â€“ The Ultimate Wrapped Frontrun</p>
</footer>

<!-- 3D VINYL -->
<canvas id="vinyl" class="fixed bottom-8 right-8 w-16 h-16 pointer-events-none opacity-0"></canvas>

<script>
/* BACKGROUND */
const canvas = document.getElementById('playlist');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;

const icons = ['ðŸŽµ','ðŸŽ§','ðŸŽ¤','ðŸ”¥','âœ¨'];
const fontSize = 20;
const columns = canvas.width / fontSize;
const drops = Array(Math.floor(columns)).fill(1);

function draw() {
  ctx.fillStyle = 'rgba(0,0,0,0.05)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#00ff88';
  ctx.font = fontSize + 'px Arial';

  for(let i=0; i<drops.length; i++){
    const text = icons[Math.floor(Math.random()*icons.length)];
    ctx.fillText(text, i*fontSize, drops[i]*fontSize);
    if(drops[i]*fontSize > canvas.height && Math.random()>0.975) drops[i]=0;
    drops[i]++;
  }
}
setInterval(draw, 50);

/* HERO TERMINAL TYPING */
const lines = [
  `> Loading your Wrapped...`,
  `> $SPOTIFY frontrunning the recap`,
  `> Viral by December.`
];

let i=0, char=0, current='';

function typeLine(){
  if(i<lines.length){
    if(char<lines[i].length){
      current += lines[i].charAt(char);
      char++;
      document.getElementById('terminal-line').textContent = current + "_";
      setTimeout(typeLine, 50);
    } else {
      i++; char=0; current="";
      setTimeout(typeLine, 600);
    }
  } else {
    gsap.to('#real-ticker', {opacity:1, duration:1});
  }
}
gsap.delayedCall(1, typeLine);

/* LIVE PRICE FETCH (DexScreener API) */
async function fetchRealPrice() {
  try {
    const pairId = 'g62zdmyefqkuqdhrifn5fyyck2ioqvgpeyhe3pz6ocm8';
    const res = await fetch(`https://api.dexscreener.com/latest/dex/pairs/solana/${pairId}`);
    const data = await res.json();

    if (!data.pair) return;

    const p = data.pair;
    const price = parseFloat(p.priceUsd).toFixed(7);
    const change = p.priceChange.h24 || 0;

    const html = `
      <div>$SPOTIFY: $${price}</div>
      <div class="${change >= 0 ? 'text-green-400':'text-red-400'}">
        24h: ${change >= 0 ? '+' : ''}${change.toFixed(2)}%
      </div>
      <div>Liq: $${p.liquidity.usd.toLocaleString()}</div>
      <div>Vol: $${p.volume.h24.toLocaleString()}</div>
    `;

    document.getElementById("real-ticker").innerHTML = html;

  } catch(err){
    document.getElementById("real-ticker").innerHTML = "<div>Error loading price</div>"
  }
}
fetchRealPrice();
setInterval(fetchRealPrice, 10000);

/* RECAP LORE */
gsap.timeline({
  scrollTrigger: { trigger:'#recap', start:'top 70%' }
})
.to('#lore', {opacity:1, duration:1})
.to('#lore', {
  text: {
    value: "Spotify Wrapped drops end of November â€“ the most viral recap event ever. $SPOTIFY frontruns the hype. Your top tracks? Straight to the moon. ðŸŽµðŸš€"
  }, duration:5
});

/* COMMUNITY TWEETS FIXED */
const tweets = [
  "Just added $SPOTIFY to my Wrapped playlist â€“ 10x vibes incoming",
  "Wrapped season = $SPOTIFY season.",
  "My top track: $SPOTIFY pumping.",
  "$SPOTIFY > labubu > everything.",
  "Spotify Wrapped? No. Spotify Pumped."
];

let tIndex = 0;
function addTweet(){
  const div = document.createElement("div");
  div.className = "terminal p-4 opacity-0 bg-black/30 rounded-lg";
  div.textContent = tweets[tIndex % tweets.length];
  tIndex++;

  document.getElementById("tweets").prepend(div);
  gsap.to(div, {opacity:1, duration:0.6});

  const list = document.getElementById("tweets");
  if(list.children.length > 5){
    const last = list.lastChild;
    gsap.to(last, {
      opacity:0, y:20, duration:0.4,
      onComplete: ()=> last.remove()
    });
  }
}
setInterval(addTweet, 4000);
addTweet();

/* 3D VINYL FIXED */
const vcanvas = document.getElementById("vinyl");
const vscene = new THREE.Scene();
const vcam = new THREE.PerspectiveCamera(75,1,0.1,1000);
const vrender = new THREE.WebGLRenderer({canvas:vcanvas, alpha:true});
vrender.setSize(64,64);

const vinylGeo = new THREE.CylinderGeometry(0.5, 0.5, 0.1, 32);
const vinylMat = new THREE.MeshBasicMaterial({color:0x00ff88});
const vinylDisk = new THREE.Mesh(vinylGeo, vinylMat);

vscene.add(vinylDisk);
vcam.position.z = 2;

function spin(){
  requestAnimationFrame(spin);
  vinylDisk.rotation.z += 0.05;
  vrender.render(vscene, vcam);
}
spin();

document.getElementById("buy-hero").addEventListener("mouseenter",()=>{
  gsap.to("#vinyl",{opacity:1, duration:0.4});
});
document.getElementById("buy-hero").addEventListener("mouseleave",()=>{
  gsap.to("#vinyl",{opacity:0, duration:0.4});
});
</script>
</body>
</html>
